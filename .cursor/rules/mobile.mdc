---
description:
globs: apps/mobile-app*/**/*.*,packages/*mobile*/**/*.*
alwaysApply: false
---

# Coinbase Design System - Mobile

You are an expert in React Native, TypeScript, react-native-reanimated, and best practices for mobile development.

## Components

Please see [Tour.tsx](mdc:packages/mobile/src/tour/Tour.tsx) and [DatePicker.tsx](mdc:packages/mobile/src/dates/DatePicker.tsx) for exemplary components.

## Accessibility Guidelines

- Use appropriate accessibilityLabel, accessibilityHint, and accessibilityRole, accessibilityState props
- Support screen readers (VoiceOver and TalkBack)
- Ensure touch targets meet minimum size requirements (44x44 points)
- Test with assistive technologies on both iOS and Android
- Support larger text sizes for users with visual impairments

## Styling

### Creating Styles

Always use react-native's `StyleSheet.create()` for static styles, defined outside components:

```ts
const styles = StyleSheet.create({
  container: { overflow: 'hidden' },
  inline: { width: 'auto', minWidth: 64 },
  block: { width: '100%', maxWidth: '100%' },
});
```

### Applying Styles

- always merge styles into a react-native style array (do not spread onto a style object)
- Use `useMemo` for computed and merged styles

```ts
const theme = useTheme();
const containerStyles = useMemo(
  () => [
    { backgroundColor: theme.color.bgPrimary },
    style, // from props
    styles.container, // from props
  ],
  [theme.color.bgPrimary, animatedStyles, style]
);

// Apply to component
<Box style={containerStyles}>
```

## Animations

In react-native we prefer to animate elements using react-native-reanimated.

### Basic Animation Setup

```typescript
import Animated, {
  useSharedValue,
  useAnimatedStyle,
  useAnimatedReaction,
  withSpring,
  runOnJS,
} from 'react-native-reanimated';
import { withMotionTiming } from '@coinbase/cds-common/animation';

// Create shared values
const opacityAnimatedValue = useSharedValue(0);
const scaleAnimatedValue = useSharedValue(1);

// Create animated styles
const animatedStyles = useAnimatedStyle(() => ({
  opacity: Number(opacityAnimatedValue.value),
  transform: [{ scale: Number(scaleAnimatedValue.value) }],
}));
```

### Collapsible Example (from Collapsible.tsx)

```typescript
const heightAnimatedValue = useSharedValue(0);
const progressAnimatedValue = useSharedValue(0);

const animatedStyle = useAnimatedStyle(() => ({
  height: heightAnimatedValue.value,
  opacity: progressAnimatedValue.value,
}));

// Animate on collapse state change with useAnimatedReaction
useAnimatedReaction(
  () => collapsed,
  (isCollapsed) => {
    'worklet';
    if (isCollapsed) {
      heightAnimatedValue.value = withMotionTiming(0);
      progressAnimatedValue.value = withMotionTiming(0);
    } else {
      heightAnimatedValue.value = withSpring(measuredHeight);
      progressAnimatedValue.value = withMotionTiming(1);
    }

    // Call JS function from worklet
    if (onAnimationComplete) {
      runOnJS(onAnimationComplete)(isCollapsed);
    }
  },
);
```

### Creating Animated Components

```typescript
const AnimatedPressable = Animated.createAnimatedComponent(Pressable);
const AnimatedBox = Animated.createAnimatedComponent(Box);
```
