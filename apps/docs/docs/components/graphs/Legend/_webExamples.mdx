## Basics

The Legend component displays series labels with their corresponding colors and indicators. By default, it appears at the top of the chart.

```jsx live
function BasicLegend() {
  const pages = useMemo(
    () => ['Page A', 'Page B', 'Page C', 'Page D', 'Page E', 'Page F', 'Page G'],
    [],
  );
  const pageViews = useMemo(() => [2400, 1398, 9800, 3908, 4800, 3800, 4300], []);
  const uniqueVisitors = useMemo(() => [4000, 3000, 2000, 2780, 1890, 2390, 3490], []);

  const numberFormatter = useCallback(
    (value: number) => new Intl.NumberFormat('en-US', { maximumFractionDigits: 0 }).format(value),
    [],
  );

  return (
    <LineChart
      enableScrubbing
      showArea
      showXAxis
      showYAxis
      height={{ base: 200, tablet: 225, desktop: 250 }}
      series={[
        {
          id: 'pageViews',
          data: pageViews,
          color: 'rgb(var(--green40))',
          label: 'Page Views',
        },
        {
          id: 'uniqueVisitors',
          data: uniqueVisitors,
          color: 'rgb(var(--purple40))',
          label: 'Unique Visitors',
          areaType: 'dotted',
        },
      ]}
      xAxis={{
        data: pages,
      }}
      yAxis={{
        showGrid: true,
        tickLabelFormatter: numberFormatter,
      }}
    >
      <Scrubber hideBeaconLabels />
      <Legend position="right" />
    </LineChart>
  );
}
```

Legend automatically scales to accommodate any number of series, wrapping items as needed.

```jsx live
function LegendAutoScale() {
  // US NOAA 2024 Precipitation data by climate region (inches)
  const precipitationData = [
    {
      id: 'northeast',
      label: 'Northeast',
      data: [5.14, 1.53, 5.73, 4.29, 3.78, 3.92, 4.19, 5.54, 2.03, 1.42, 2.95, 3.89],
      color: 'rgb(var(--blue40))',
    },
    {
      id: 'upperMidwest',
      label: 'Upper Midwest',
      data: [1.44, 0.49, 2.16, 3.67, 5.44, 6.21, 4.02, 3.67, 0.92, 1.47, 3.05, 1.48],
      color: 'rgb(var(--green40))',
    },
    {
      id: 'ohioValley',
      label: 'Ohio Valley',
      data: [4.74, 1.83, 3.1, 5.42, 5.69, 3.29, 5.02, 2.57, 4.13, 0.79, 4.31, 3.67],
      color: 'rgb(var(--orange40))',
    },
    {
      id: 'southeast',
      label: 'Southeast',
      data: [5.48, 3.11, 5.73, 2.97, 5.45, 3.28, 7.18, 5.67, 7.93, 1.33, 2.69, 3.21],
      color: 'rgb(var(--yellow40))',
    },
    {
      id: 'northernRockiesAndPlains',
      label: 'Northern Rockies and Plains',
      data: [0.64, 1.01, 1.06, 2.12, 3.34, 2.65, 1.54, 1.89, 0.95, 0.57, 1.23, 0.67],
      color: 'rgb(var(--indigo40))',
    },
    {
      id: 'south',
      label: 'South',
      data: [4.19, 1.79, 2.93, 3.84, 5.25, 3.4, 4.27, 1.84, 3.08, 0.52, 4.5, 2.62],
      color: 'rgb(var(--pink40))',
    },
    {
      id: 'southwest',
      label: 'Southwest',
      data: [1.12, 1.5, 1.52, 0.75, 0.76, 1.27, 1.44, 2.01, 0.62, 1.08, 1.23, 0.25],
      color: 'rgb(var(--purple40))',
    },
    {
      id: 'northwest',
      label: 'Northwest',
      data: [5.69, 3.67, 3.32, 1.95, 2.08, 1.31, 0.28, 0.81, 0.95, 2.03, 5.45, 5.8],
      color: 'rgb(var(--red40))',
    },
    {
      id: 'west',
      label: 'West',
      data: [3.39, 4.7, 3.09, 1.07, 0.55, 0.12, 0.23, 0.26, 0.22, 0.4, 2.7, 2.54],
      color: 'rgb(var(--teal40))',
    },
  ];

  const xAxisData = [
    'January',
    'February',
    'March',
    'April',
    'May',
    'June',
    'July',
    'August',
    'September',
    'October',
    'November',
    'December',
  ];

  return (
    <VStack gap={2}>
      <Text font="headline" textAlign="center">
        2024 Precipitation by Climate Region
      </Text>
      <LineChart
        enableScrubbing
        height={{ base: 300, tablet: 400, desktop: 500 }}
        series={precipitationData}
        showXAxis
        xAxis={{ data: xAxisData, label: 'Month', showLine: true, showTickMarks: true }}
        showYAxis
        yAxis={{ label: 'Precipitation (in)', showLine: true, showTickMarks: true, showGrid: true }}
        showArea
      >
        <Scrubber hideOverlay hideBeaconLabels />
        <Legend position="bottom" />
        <ChartTooltip valueFormatter={(value) => `${value} in`} />
      </LineChart>
    </VStack>
  );
}
```

## Position

The `position` prop controls where the legend appears. Use `justifyContent` to align the legend items within their container.

```jsx live
<CartesianChart
  height={{ base: 150, tablet: 200, desktop: 250 }}
  inset={{ top: 8, bottom: 8, left: 0, right: 0 }}
  series={[
    {
      id: 'revenue',
      label: 'Revenue',
      data: [455, 520, 380, 455, 285, 235],
      yAxisId: 'revenue',
      color: 'rgb(var(--yellow40))',
      legendIndicator: 'squircle',
    },
    {
      id: 'profitMargin',
      label: 'Profit Margin',
      data: [23, 20, 16, 38, 12, 9],
      yAxisId: 'profitMargin',
      color: 'var(--color-fgPositive)',
      legendIndicator: 'squircle',
    },
  ]}
  xAxis={{
    data: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
    scaleType: 'band',
  }}
  yAxis={[
    {
      id: 'revenue',
      domain: { min: 0 },
    },
    {
      id: 'profitMargin',
      domain: { min: 0, max: 100 },
    },
  ]}
>
  <XAxis showLine showTickMarks />
  <YAxis
    showGrid
    showLine
    showTickMarks
    axisId="revenue"
    position="left"
    requestedTickCount={5}
    width={60}
    tickLabelFormatter={(value) => `$${value}k`}
  />
  <YAxis
    showLine
    showTickMarks
    axisId="profitMargin"
    position="right"
    requestedTickCount={5}
    tickLabelFormatter={(value) => `${value}%`}
  />
  <BarPlot />
  <Legend position="bottom" justifyContent="flex-end" width="100%" />
</CartesianChart>
```

## Indicator

Series can use different indicators via the `legendIndicator` property. Available variants are `pill`, `circle`, `square`, and `squircle`.

```jsx live
function IndicatorVariants() {
  const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];

  return (
    <LineChart
      showArea
      showXAxis
      showYAxis
      height={{ base: 200, tablet: 250, desktop: 300 }}
      series={[
        {
          id: 'pill',
          label: 'Pill',
          data: [120, 150, 130, 170, 160, 190],
          color: 'rgb(var(--blue40))',
          legendIndicator: 'pill',
        },
        {
          id: 'circle',
          label: 'Circle',
          data: [80, 110, 95, 125, 115, 140],
          color: 'rgb(var(--green40))',
          legendIndicator: 'circle',
        },
        {
          id: 'square',
          label: 'Square',
          data: [60, 85, 70, 100, 90, 115],
          color: 'rgb(var(--orange40))',
          legendIndicator: 'square',
        },
        {
          id: 'squircle',
          label: 'Squircle',
          data: [40, 60, 50, 75, 65, 85],
          color: 'rgb(var(--purple40))',
          legendIndicator: 'squircle',
        },
      ]}
      xAxis={{ data: months }}
      yAxis={{ domain: { min: 0 }, showGrid: true }}
    >
      <Legend position="left" />
    </LineChart>
  );
}
```

## Dynamic Data

The `ItemComponent` prop allows you to create custom legend items that display dynamic data. This example shows the current value at the scrubber position, falling back to the last data point when not scrubbing. The `Legend` component passes `seriesId` to each `ItemComponent`, which you can use to look up the series data from context.

```jsx live
function CustomLegendWithValues() {
  // Sample polling data over time
  const timeLabels = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

  const series = [
    {
      id: 'candidate-a',
      label: 'Candidate A',
      data: [48, 47, 46, 45, 44, 43, 42, 41, 40, 39, 38, 38],
      color: 'rgb(var(--blue40))',
      legendIndicator: 'circle',
    },
    {
      id: 'candidate-b',
      label: 'Candidate B',
      // Candidate B entered the race in April and gained momentum
      data: [null, null, null, 6, 10, 14, 18, 22, 26, 29, 32, 35],
      color: 'rgb(var(--orange40))',
      legendIndicator: 'circle',
    },
    {
      id: 'candidate-c',
      label: 'Candidate C',
      data: [52, 53, 54, 49, 46, 43, 40, 37, 34, 32, 30, 27],
      color: 'rgb(var(--gray40))',
      legendIndicator: 'circle',
    },
  ];

  // Custom legend item component that displays the current scrubbed value
  const ValueLegendItem = memo(({ seriesId, label, color, legendIndicator }: LegendItemProps) => {
    const { scrubberPosition } = useScrubberContext();
    const { series, dataLength } = useCartesianChartContext();

    // Get the data index - use scrubber position or fall back to last point
    const dataIndex = scrubberPosition ?? dataLength - 1;

    // Find the series using seriesId prop and get the value at the current index
    const seriesData = series.find((s) => s.id === seriesId);
    const rawValue = seriesData?.data?.[dataIndex];

    // Format the value - show '--' if no data, otherwise show whole number with %
    const formattedValue =
      rawValue === null || rawValue === undefined ? '--' : `${Math.round(rawValue)}%`;

    return (
      <HStack alignItems="center" gap={1}>
        <DefaultLegendIndicator color={color} indicator={legendIndicator} />
        <Text font="label2">{label}</Text>
        <Text font="label1" tabularNumbers>
          {formattedValue}
        </Text>
      </HStack>
    );
  });

  return (
    <VStack gap={2}>
      <Text font="headline" textAlign="center">
        Election Polls
      </Text>
      <LineChart
        enableScrubbing
        showArea
        showXAxis
        showYAxis
        height={{ base: 200, tablet: 250, desktop: 300 }}
        series={series}
        xAxis={{
          data: timeLabels,
        }}
        yAxis={{
          domain: { min: 0, max: 100 },
          showGrid: true,
          tickLabelFormatter: (value) => `${value}%`,
        }}
      >
        <Scrubber hideBeaconLabels />
        <Legend ItemComponent={ValueLegendItem} justifyContent="flex-start" paddingX={2} />
      </LineChart>
    </VStack>
  );
}
```

## Styling

### Interaction

Create clickable legend items that emphasize specific series on the chart. In this example, clicking a legend item highlights that series while dimming the others. Clicking the same item again returns all series to normal.

```jsx live
function InteractiveLegend() {
  const [emphasizedId, setEmphasizedId] = useState<string | null>(null);

  const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

  const seriesConfig = [
    {
      id: 'revenue',
      label: 'Revenue',
      data: [120, 150, 180, 165, 190, 210, 240, 220, 260, 280, 310, 350],
      baseColor: '--blue',
    },
    {
      id: 'expenses',
      label: 'Expenses',
      data: [80, 95, 110, 105, 120, 130, 145, 140, 155, 165, 180, 195],
      baseColor: '--orange',
    },
    {
      id: 'profit',
      label: 'Profit',
      data: [40, 55, 70, 60, 70, 80, 95, 80, 105, 115, 130, 155],
      baseColor: '--green',
    },
  ];

  // Toggle emphasis - clicking the same item de-emphasizes it
  const handleToggle = useCallback((seriesId: string) => {
    setEmphasizedId((prev) => (prev === seriesId ? null : seriesId));
  }, []);

  // Custom legend item using Chip for interactivity
  const ChipLegendItem = memo(({ seriesId, label }: LegendItemProps) => {
    const chipRef = useRef<HTMLButtonElement>(null);
    const isEmphasized = emphasizedId === seriesId;
    const config = seriesConfig.find((s) => s.id === seriesId);
    const baseColor = config?.baseColor ?? '--gray';

    // Restore focus when chip becomes emphasized
    useEffect(() => {
      if (isEmphasized && chipRef.current) {
        chipRef.current.focus();
      }
    }, [isEmphasized]);

    return (
      <Chip
        ref={chipRef}
        aria-label={`${isEmphasized ? 'Remove emphasis from' : 'Emphasize'} ${label} series`}
        aria-pressed={isEmphasized}
        compact
        inverted={isEmphasized}
        onClick={() => handleToggle(seriesId)}
        style={{
          backgroundColor: `rgb(var(${baseColor}10))`,
          borderWidth: 0,
          color: 'var(--color-fg)',
          outlineColor: `rgb(var(${baseColor}50))`,
        }}
      >
        <HStack alignItems="center" gap={1}>
          <DefaultLegendIndicator color={`rgb(var(${baseColor}50))`} />
          {label}
        </HStack>
      </Chip>
    );
  });

  // Build series with dynamic opacity based on emphasis state
  const series = useMemo(() => {
    return seriesConfig.map((config) => {
      const isEmphasized = emphasizedId === config.id;
      const isDimmed = emphasizedId !== null && !isEmphasized;

      return {
        id: config.id,
        label: config.label,
        data: config.data,
        color: `rgb(var(${config.baseColor}40))`,
        opacity: isDimmed ? 0.3 : 1,
      };
    });
  }, [emphasizedId]);

  return (
    <VStack gap={2}>
      <Text font="headline" textAlign="center">
        Financial Overview
      </Text>
      <LineChart
        showArea
        showXAxis
        showYAxis
        height={{ base: 300, tablet: 350, desktop: 400 }}
        series={series}
        xAxis={{
          data: months,
        }}
        yAxis={{
          domain: { min: 0 },
          showGrid: true,
          tickLabelFormatter: (value) => `$${value}k`,
        }}
      >
        <Legend ItemComponent={ChipLegendItem} gap={1} paddingTop={1} />
      </LineChart>
    </VStack>
  );
}
```

### Indicator

Series can use different indicators via the `legendIndicator` property. Available variants are `pill`, `circle`, `square`, and `squircle`. This is useful for distinguishing between different data types, such as actual vs. forecasted values.

```jsx live
function RevenueForecast() {
  const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

  // Actual revenue (first 9 months)
  const actualRevenue = [320, 380, 420, 390, 450, 480, 520, 490, 540, null, null, null];

  // Forecasted revenue (last 3 months)
  const forecastRevenue = [null, null, null, null, null, null, null, null, null, 580, 620, 680];

  const numberFormatter = useCallback(
    (value: number) => `$${new Intl.NumberFormat('en-US', { maximumFractionDigits: 0 }).format(value)}k`,
    [],
  );

  // Pattern settings for dotted fill (similar to DottedArea)
  const patternSize = 4;
  const dotSize = 1;
  const patternId = useId();
  const maskId = useId();
  const legendPatternId = useId();

  // Custom legend indicator that matches the dotted bar pattern
  const DottedLegendIndicator = (
    <svg width={10} height={10} viewBox="0 0 10 10">
      <defs>
        <pattern
          id={legendPatternId}
          patternUnits="userSpaceOnUse"
          width={patternSize / 2}
          height={patternSize / 2}
        >
          <circle cx={patternSize / 4} cy={patternSize / 4} r={dotSize / 2} fill="white" />
        </pattern>
        <mask id={`${legendPatternId}-mask`}>
          <rect x={1} y={1} width={8} height={8} rx={2} fill={`url(#${legendPatternId})`} />
        </mask>
      </defs>
      <g mask={`url(#${legendPatternId}-mask)`}>
        <rect x={1} y={1} width={8} height={8} rx={2} fill="var(--color-fgPositive)" />
      </g>
      <rect x={1} y={1} width={8} height={8} rx={2} fill="transparent" stroke="var(--color-fgPositive)" strokeWidth={2} />
    </svg>
  );

  // Custom bar component that renders bars with dotted pattern fill
  const DottedBarComponent = memo((props) => {
    const { dataX, x, y } = props;
    // Create unique IDs per bar so patterns are scoped to each bar
    const uniqueMaskId = `${maskId}-${dataX}`;
    const uniquePatternId = `${patternId}-${dataX}`;
    return (
      <>
        <defs>
          {/* Pattern positioned relative to this bar's origin */}
          <pattern
            id={uniquePatternId}
            patternUnits="userSpaceOnUse"
            width={patternSize}
            height={patternSize}
            x={x}
            y={y}
          >
            <circle cx={patternSize / 2} cy={patternSize / 2} r={dotSize} fill="white" />
          </pattern>
          <mask id={uniqueMaskId}>
            <DefaultBar {...props} fill={`url(#${uniquePatternId})`} />
          </mask>
        </defs>
        <g mask={`url(#${uniqueMaskId})`}>
          <DefaultBar {...props} />
        </g>
        <DefaultBar {...props} fill="transparent" stroke={props.fill} strokeWidth={4} />
      </>
    );
  });

  return (
    <VStack gap={2}>
      <Text font="headline" textAlign="center">
        Annual Revenue
      </Text>
      <CartesianChart
        height={{ base: 200, tablet: 250, desktop: 300 }}
        inset={0}
        series={[
          {
            id: 'actual',
            label: 'Historical',
            data: actualRevenue,
            color: 'var(--color-fgPositive)',
            legendIndicator: 'squircle',
            stackId: 'revenue',
          },
          {
            id: 'forecast',
            label: 'Forecasted',
            data: forecastRevenue,
            color: 'var(--color-fgPositive)',
            legendIndicator: DottedLegendIndicator,
            stackId: 'revenue',
            BarComponent: DottedBarComponent,
          },
        ]}
        xAxis={{
          data: months,
          scaleType: 'band',
        }}
        yAxis={{
          domain: { min: 0 },
          showGrid: true,
        }}
      >
        <XAxis showLine showTickMarks />
        <YAxis
          showLine
          showTickMarks
          position="left"
          requestedTickCount={5}
          width={60}
          tickLabelFormatter={numberFormatter}
        />
        <BarPlot />
        <Legend />
      </CartesianChart>
    </VStack>
  );
}
```
